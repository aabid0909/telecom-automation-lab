from flask import Flask, request, jsonify
import time

app = Flask(__name__)

# Global State Simulation
registration_attempts = {}

# Health check (used by Jenkins / monitoring)
@app.route("/health", methods=["GET"])
def health():
    return jsonify({"status": "UP"}), 200

# Simulates IMS / UE registration
@app.route("/ims/register", methods=["POST"])
def ims_register():
    data = request.json

    if not data or "subscriberId" not in data:
        return jsonify({"error": "subscriberId missing"}), 400

    time.sleep(1)  # simulate network latency

    return jsonify({
        "subscriberId": data["subscriberId"],
     
# Simulates subscriber provisioning
@app.route("/ims/provision", methods=["POST"])
def ims_provision():
    data = request.json

    if not data or "subscriberId" not in data:
        return jsonify({"error": "subscriberId missing"}), 400

    return jsonify({
        "subscriberId": data["subscriberId"],
        "provisioningStatus": "COMPLETED"
    }), 200


# Simulates network function status
@app.route("/nf/status", methods=["GET"])
def nf_status():
    return jsonify({
        "networkFunction": "IMS-Core",
        "state": "ACTIVE"
    }), 200


if __name__ == "__main__":
    app.run(host="0.0.0.0", port=8090)
